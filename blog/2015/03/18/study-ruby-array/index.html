    <!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="author" content="the world as code">
		<meta name="description" content="about IT Infrastructure, DevOps, and Hacker philosophy.">
		<meta name="generator" content="Hugo 0.16-DEV" />
		<title>Ruby基礎復習(5) 配列(Array) &middot; the world as code</title>
		<link rel="shortcut icon" href="https://chroju.github.io/images/favicon.ico">
		<link rel="stylesheet" href="https://chroju.github.io/css/style.css">
		<link rel="stylesheet" href="https://chroju.github.io/css/highlight.css">
		<link rel="stylesheet" href="https://chroju.github.io/css/monosocialiconsfont.css">
		
		<link href="https://chroju.github.io/atom.xml" rel="alternate" type="application/rss+xml" title="the world as code" />
		
	</head>

    <body>
       <nav class="main-nav">
	
	
		<a href='https://chroju.github.io/'> <span class="arrow">←</span>Home</a>
	

	
		<a href='https://chroju.github.io/about'>About</a>
	

	
	<a class="cta" href="https://chroju.github.io/atom.xml">Subscribe</a>
	
</nav>


        <section id="wrapper">
            <article class="post">
                <header>
                    <h1>Ruby基礎復習(5) 配列(Array)</h1>
                    <h2 class="headline">March 18, 2015</h2>
                </header>
                <section id="post-body">
                    <p>『パーフェクトRuby』p.171より。</p>

<p>まずは配列の生成をいくつか。<code>#new(a,b)</code>で生成したとき、各要素は同じオブジェクトとなるので注意。またブロックで受け取ると、インデックスを引数としてブロック内の処理を実行した結果が値となる。</p>

<pre><code class="language-ruby">a1 = Array.new(3,1) # =&gt; [1, 1, 1]
a2 = Array.new(3, &quot;hoge&quot;) # =&gt; [&quot;hoge&quot;, &quot;hoge&quot;, &quot;hoge&quot;]
a3 = [&quot;hoge&quot;, &quot;fuga&quot;, &quot;piyo&quot;] # =&gt; [&quot;hoge&quot;, &quot;fuga&quot;, &quot;piyo&quot;]
a4 = Array.new(3) {|i| i * 5} # =&gt; [0, 5, 10]

a2[0] &lt;&lt; &quot;fuga&quot;
p a2 # =&gt; [&quot;hogefuga&quot;, &quot;hogefuga&quot;, &quot;hogefuga&quot;]
</code></pre>

<p>基本的な操作系メソッド。演算子メソッドは直感的でほんといいなーと思う。なお、<code>#&lt;&lt;</code>は<code>#concat</code>と同義。<code>#==</code>と<code>#eql?</code>も同義。</p>

<pre><code class="language-ruby">array = [&quot;hoge&quot;, &quot;fuga&quot;, &quot;piyo&quot;]

array.length # =&gt; 3
array.size # =&gt; 3
array.empty? # =&gt; false
array.include?(&quot;fuga&quot;) # =&gt; true

p array * 3 # =&gt; [&quot;hoge&quot;, &quot;fuga&quot;, &quot;piyo&quot;, &quot;hoge&quot;, &quot;fuga&quot;, &quot;piyo&quot;, &quot;hoge&quot;, &quot;fuga&quot;, &quot;piyo&quot;]
p array + [1, 2] # =&gt; [&quot;hoge&quot;, &quot;fuga&quot;, &quot;piyo&quot;, 1, 2]
p array - [&quot;hoge&quot;, &quot;piyo&quot;] # =&gt; [&quot;fuga&quot;]
p array &amp; [&quot;piyo&quot;] # =&gt; [&quot;piyo&quot;]
array &lt;&lt; &quot;hogehoge&quot; # =&gt; [&quot;hoge&quot;, &quot;fuga&quot;, &quot;piyo&quot;, &quot;hogehoge&quot;]
array2 = [&quot;hoge&quot;, &quot;fuga&quot;, &quot;piyo&quot;]
array3 = [&quot;hoge&quot;, &quot;fuga&quot;, &quot;piyo&quot;, &quot;hogehoge&quot;]
array == array2 # =&gt; false
array == array3 # =&gt; true
</code></pre>

<p>要素の取り出し。<code>#[a, b]</code>が添字aから長さbの配列を取り出すのに対し、<code>#values_at(a, b)</code>が添字a, bの要素を取り出して配列を作る、という点が異なるのが注意かも。</p>

<p>また範囲外の添字を指定したときの振る舞いだが、<code>#[]</code>がnilを返すのに対し、第一引数のみの<code>#fetch</code>はIndexErrorを返す。<code>#fetch</code>に第二引数を指定すると、範囲外を呼び出したときに第二引数を返すようになる。</p>

<p><code>#sample</code>はランダム抽出。</p>

<pre><code class="language-ruby">array = (1..5).to_a

array[1] # =&gt; 2
array[-1] # =&gt; 5
array[1, 3] # =&gt; [2, 3, 4]
array[2..4] # =&gt; [3, 4, 5]

array.values_at(3) # =&gt; 4
array.values_at(0, 3, 4) # =&gt; [1, 4, 5]

array.fetch(5) # =&gt; IndexError
array[5] # =&gt; nil
array.fetch(5, &quot;error&quot;) # =&gt; &quot;error&quot;

array.first # =&gt; 1
array.last # =&gt; 5
array.last(2) # =&gt; [4, 5]

array.sample # =&gt; 3
</code></pre>

<p>要素の追加削除。添字を使って普通に要素の入れ替えはできるのだが、面白いのはレンジにない添字を指定してもOutOfBounds扱いにはならず、足りない箇所はnilを埋めて補完してくれること。<code>#insert</code>は第一引数をインデックスとする要素の直前に、第二引数以降の要素を挿入する。あと<code>#fill</code>は全要素を同じオブジェクトで埋め込む。</p>

<pre><code class="language-ruby">array = (1..5).to_a

array[1] = 0 # =&gt; [1, 0, 3, 4, 5]
array[8] = 10 # =&gt; [1, 0, 3, 4, 5, nil, nil, nil, 10]

array.push(3) # =&gt; [1, 0, 3, 4, 5, nil, nil, nil, 10, 3]
array.pop # =&gt; 3
p array # =&gt; [1, 0, 3, 4, 5, nil, nil, nil, 10]

array.shift # =&gt; [0, 3, 4, 5, nil, nil, nil, 10]
array.unshift(1) # =&gt; [1, 0, 3, 4, 5, nil, nil, nil, 10]

array.insert(2, &quot;a&quot;, &quot;b&quot;) # =&gt; [1, 0, &quot;a&quot;, &quot;b&quot;, 3, 4, 5, nil, nil, nil, 10]

array.fill(0) # =&gt; [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
array.clear # =&gt; []
p array # =&gt; []
</code></pre>

<p>要素の選択周り。ブロック内の処理でtrueとなった要素について、<code>#select</code>では抽出、<code>#reject</code>では削除を行う。いずれも破壊的／非破壊的の別があり。<code>#keep_if</code>は<code>#select!</code>と同様の動作をするが、削除する要素がなかった場合に<code>#select!</code>がnilを返す一方で、<code>#keep_if</code>がレシーバをそのまま返すという違いがある。<code>#delete_if</code>についても同様。ブロック内での評価ではなく、単純に特定の値と等しい要素を削除したい場合は<code>#delete</code>が使える。これは破壊的。<code>#delete_at</code>は添字による指定で削除する。</p>

<pre><code class="language-ruby">array = (1..5).to_a
array.select {|i| i.even? } # =&gt; [2, 4]
p array # =&gt; [1, 2, 3, 4, 5]
array.select! {|i| i.even? } # =&gt; [2, 4]
p array # =&gt; [2, 4]

array = (1..5).to_a
array.reject {|i| i.even? } # =&gt; [1, 3, 5]
p array # =&gt; [1, 2, 3, 4, 5]
array.reject! {|i| i.even? } # =&gt; [1, 3, 5]
p array # =&gt; [1, 3, 5]

array = [2, 4, 6]
array.select! {|i| i.even? } # =&gt; nil
array.keep_if {|i| i.even? } # =&gt; [2, 4, 6]
array.reject! {|i| i.odd? } # =&gt; nil
array.delete_if {|i| i.odd? } # =&gt; [2, 4, 6]

array.delete 4 # =&gt; [2, 6]
array.delete_at 1 # =&gt; [2]
</code></pre>

<p>同様に要素の切り出しでは<code>#slice</code>というメソッドもあるが、引数の与え方で動作が変わってくる。Integerの引数1つを与えると、そのインデックスにある要素を返す。範囲外の場合はnilが返る。Integerの引数2つでは、第一引数のインデックスより、第二引数の個数分要素を切り出して返す。Rangeを引数とすると、その範囲のインデックスにあたる要素を返す。</p>

<p>またいずれの場合でも<code>!</code>による破壊的メソッドがあるが、ここでは戻り値となる要素が配列より削除される。</p>

<pre><code class="language-ruby">a = [2, 4, 6, 9]
a.slice(1) # =&gt; 4
a.slice(1, 4) # =&gt; [4, 6, 9]
a.slice(1..2) # =&gt; [4, 6]

a.slice(2) # =&gt; 6
p a # =&gt; [2, 4, 9]
a.slice(0..1) # =&gt; [2, 4]
p a # =&gt; [9]
</code></pre>

<p>整形。<code>#compact</code>はnilを要素から除外する。<code>#uniq</code>は重複した要素を除外。<code>#reverse</code>は要素の順序を逆にする。<code>#flatten</code>は多次元配列を1次元に変換する。いずれも<code>!</code>を付けることで破壊的になる。また<code>#sort!</code>や<code>#map!</code>といった破壊的要素を使うことで、実行結果により自身を更新できる。</p>

<pre><code class="language-ruby">a = [5, 3, nil, 3, nil, 9, 1, [4, 3]]
a.compact! # =&gt; [5, 3, 3, 9, 1, [4, 3]]
a.uniq! # =&gt; [5, 3, 9, 1, [4, 3]]
a.reverse! # =&gt; [[4, 3], 1, 9, 3, 5]
a.flatten! # =&gt; [4, 3, 1, 9, 3, 5]
a.sort! # =&gt; [1, 3, 3, 4, 5, 7, 9]
a.map! {|i| i * 2 } # =&gt; [2, 6, 6, 8, 10, 14, 18]
</code></pre>

<p>複製。<code>#dup</code>は内容のみを複製する（浅いコピー）のに対し、<code>#clone</code>はfrozen等の情報も複製する。</p>

<pre><code class="language-ruby">a = [1, 2, 3].freeze
a[0] = 5 # =&gt; RuntimeError

b = a.dup
b[0] = 5 # =&gt; [5, 2, 3]

c = a.clone
c[0] = 5 # =&gt; RuntimeError
</code></pre>

<p>若干変わったものを最後にいくつか。<code>#transpose</code>は多次元配列を行列とみなして、行と列の入れ替えを行う。破壊的メソッドはない。<code>#bsearch</code>はソートされている配列に対して使用し、二分探索で最初に見つかった要素を返す。<code>#join</code>は各要素を連結した値を返す。引数にセパレータを渡すことも可。<code>#shuffle</code>は配列をランダムにシャッフルする。</p>

<pre><code class="language-ruby">a = [[1, 2], [3, 4]]
a.transpose # =&gt; [[1, 3], [2, 4]]

a = [0, 3, 5, 7, 9]
a.bsearch {|i| i &gt; 2 } # =&gt; 3

a.join # =&gt; &quot;03579&quot;
a.join(&quot;-&quot;) # =&gt; &quot;0-3-5-7-9&quot;

a.shuffle!
p a # =&gt; [5, 9, 0, 3, 7]
</code></pre>

                </section>
            </article>
            <footer id="post-meta" class="clearfix">
                
                        <img class="avatar" src="https://chroju.github.io/images/avatar.png">
                        <div>
                            <span class="dark">the world as code</span>
                            <span></span>
                        </div>
                    
                <section id="sharing">
                    <a class="twitter" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fchroju.github.io%2fblog%2f2015%2f03%2f18%2fstudy-ruby-array%2f - Ruby%e5%9f%ba%e7%a4%8e%e5%be%a9%e7%bf%92%285%29%20%e9%85%8d%e5%88%97%28Array%29 "><span class="icon-twitter"> Tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>

                </section>
            </footer>

            

            <ul id="post-list" class="archive readmore">
    <h3>Read more</h3>
    
    
        
        <li>
            <a href="https://chroju.github.io/blog/2017/08/26/aws_sysops_administrator/">AWS Certified Sysops Administratorを取得した<aside class="dates">Aug 26</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2017/08/06/builderson_2017/">builderson2017に行ってきた<aside class="dates">Aug 6</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2017/06/12/very_exhausted_because_of_toil/">Toilの地獄から抜け出す術を知りたい<aside class="dates">Jun 12</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2017/05/05/infrastructure_as_code_book/">O&#39;Reilly『Infrastructure as Code』読了<aside class="dates">May 5</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2017/02/15/vimperator_to_vivaldi/">VimperatorからVivaldi &#43; Vimiumへ乗り換える<aside class="dates">Feb 15</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2017/02/07/try_on_serverless_architecture/">サーバーレスっぽいインフラをどう管理していくか<aside class="dates">Feb 7</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2017/02/05/barocco_review/">Baroccoで分割キーボードデビューした<aside class="dates">Feb 5</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2016/12/28/looking_back_2016/">2016年総括 - 技術者って何なのかやっと理解した<aside class="dates">Dec 28</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2016/12/27/esa_io_personal_use/">esa.ioを個人利用している話<aside class="dates">Dec 27</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2016/12/17/engineering_problem_solving/">エンジニアの問題解決力とは何か<aside class="dates">Dec 17</aside></a>
        </li>
        
   
</ul>
            <footer id="footer">
    
        
<div id="social">
    
    <a class="symbol" href="https://github.com/chroju">
        circlegithubalt
    </a>
    
    <a class="symbol" href="https://twitter.com/chroju">
        circletwitterbird
    </a>
    
</div>

    
    <p class="small">
    
        written by chroju
    
    </p>
</footer>

        </section>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://chroju.github.io/js/main.js"></script>
<script src="https://chroju.github.io/js/highlight.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


    </body>
</html>
