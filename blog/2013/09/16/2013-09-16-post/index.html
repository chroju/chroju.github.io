    <!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="author" content="the world as code">
		<meta name="description" content="about IT Infrastructure, DevOps, and Hacker philosophy.">
		<meta name="generator" content="Hugo 0.16-DEV" />
		<title>バージョン管理に注意しながら、Ruby on Railsの動作環境を構築する &middot; the world as code</title>
		<link rel="shortcut icon" href="https://chroju.github.io/images/favicon.ico">
		<link rel="stylesheet" href="https://chroju.github.io/css/style.css">
		<link rel="stylesheet" href="https://chroju.github.io/css/highlight.css">
		<link rel="stylesheet" href="https://chroju.github.io/css/monosocialiconsfont.css">
		
		<link href="https://chroju.github.io/atom/index.xml" rel="alternate" type="application/rss+xml" title="the world as code" />
		
	</head>

    <body>
       <nav class="main-nav">
	
	
		<a href='https://chroju.github.io/'> <span class="arrow">←</span>Home</a>
	

	
		<a href='https://chroju.github.io/about'>About</a>
	

	
	<a class="cta" href="https://chroju.github.io/atom/index.xml">Subscribe</a>
	
</nav>


        <section id="wrapper">
            <article class="post">
                <header>
                    <h1>バージョン管理に注意しながら、Ruby on Railsの動作環境を構築する</h1>
                    <h2 class="headline">September 16, 2013</h2>
                </header>
                <section id="post-body">
                    

<p>資料によっていろいろ言っていることが違うので、自分なりに調べながらまとめる。こういうのchef?とかで書いとけば環境構築楽になるんだろうな。</p>

<h2 id="必要なもの:c0e8053d95a0479a6e2a540c4d5b8bd7">必要なもの</h2>

<ul>
<li>Ruby ……当然のごとく</li>

<li><p>Rails ……当然のごとく</p></li>

<li><p>rbenv ……RubyとRailsの管理システム</p></li>

<li><p>ruby-build ……rbenvとセットで使うっぽいがよくわかってない</p></li>

<li><p>Git ……バージョン管理。必須ではない気もするがあった方がいい。rbenvとかのインストールにも使う。</p></li>

<li><p>RubyGems ……Rubyのパッケージ管理システム</p></li>

<li><p>Bundler ……Gemパッケージの管理システム</p></li>
</ul>

<p>こんなところだろうか。直接的に必要なものの他に、それぞれを管理するためのツールが必要だったりしてなかなかに複雑であった。あとhomebrewとかのあたりまで遡るとキリが無くなりそうなのでさすがに割愛。というかOSによっても違ってきちゃうし。readlineとかopensslとかも依存関係があるっぽいんだけどよくわからないので割愛……。んー、意味あるのかこの記事。俺がRoRで使ってる環境はちなみにCent OSなので、その前提で書きます。</p>

<h2 id="rbenv:c0e8053d95a0479a6e2a540c4d5b8bd7">rbenv</h2>

<p>本とか読んでるとRubyのバージョン管理にはRVM使わせているものが多いんだけど、rbenvの方が軽くてBundlerとの相性も良いらしい。よってrbenvを使うことにする。</p>

<p>参考：(<a href="http://passingloop.tumblr.com/post/10512902196/difference-between-rbenv-and-rvm">http://passingloop.tumblr.com/post/10512902196/difference-between-rbenv-and-rvm</a>)</p>

<p>インストール先のパスが迷う。。。ホームフォルダに不可視で入れるのが気持ちとしてスッキリするのでそれを採用。</p>

<blockquote>$ git clone git://github.com/sstephenson/rbenv.git ~/.rbenv</blockquote>

<p>で、bash_profileにパスを追加。</p>

<blockquote>echo 'export PATH="$HOME/.rbenv/bin:$PATH"' >> ~/.bash_profile
echo 'eval "$(rbenv init -)"' >> ~/.bash_profile
source ~/.bash_profile</blockquote>

<h3 id="追記:c0e8053d95a0479a6e2a540c4d5b8bd7">追記</h3>

<p>実はこの記事書く前にすでにRVM入れちゃってたんだけど（今読んでる『RailsによるアジャイルWebアプリケーション開発』にはRVMが紹介されてたので）、RVM削除してrbenvを入れなおそうと思い立って調べてみた。そこで辿り着いたRVMのアンインストールコマンドがなかなかに衝撃的だったので追記。</p>

<blockquote>$ rvm seppuku</blockquote>

<p>切腹！！！ｗｗｗｗ</p>

<h2 id="ruby-build:c0e8053d95a0479a6e2a540c4d5b8bd7">ruby-build</h2>

<p>よくわかってないけど入れる。わかっていることとしては、これがないとrbenv installコマンドが使えない。rbenvのプラグインとしての位置づけらしいので、.rbenvフォルダ配下に入れる。公式のREADMEにもそう書かれてます故。</p>

<blockquote>$ git clone git://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build</blockquote>

<h2 id="ruby:c0e8053d95a0479a6e2a540c4d5b8bd7">Ruby</h2>

<p>Rubyはrbenvを使ってインストール。バージョンについては都度変わるので、$ rbenv install -lコマンドで落とせるバージョンを確認しつつ、必要なものを入れる感じで。まぁ使うバージョン選択できるんだから、そんなにセンシティブになる必要はないと思うが。</p>

<blockquote>$ rbenv install 1.9.3</blockquote>

<p>デフォで使うRubyのバージョンを設定。</p>

<blockquote>$ rbenv global 1.9.3 # これで設定
$ rbenv rehash # Rubyの新しいバージョンやコマンド付きのGemを落としたときに実行する</blockquote>

<p>インストール済みのRubyのバージョンは$ rbenv versionsで確かめられる。ちょうど今年の上半期にRuby 2.0が出たばかりだし、このあたりはしばらくの間重宝しそう。</p>

<h2 id="rubygems:c0e8053d95a0479a6e2a540c4d5b8bd7">RubyGems</h2>

<p>入れる方法はいろいろあるみたいだけど、自分の使ってるCent OSを基本として考えて、yumで入れることにする。</p>

<blockquote>$ yum install rubygems</blockquote>

<p>めんどかったら-yオプション付ければ対話なしで全部インストールされておしまい。</p>

<h2 id="rails:c0e8053d95a0479a6e2a540c4d5b8bd7">Rails</h2>

<p>いよいよRailsのインストール。RailsはGemパッケージとして配布されているので、今入れたRubyGemsを使ってインストールする。特定のバージョンを使う場合は-vオプションを使う。オプション無しだと最新版が入る。rbenvでRubyの複数バージョン切り替えるみたいにRailsもやってみたいんだけど、やり方がわからない。。。</p>

<blockquote>$ gem install rails</blockquote>

<h2 id="bundler:c0e8053d95a0479a6e2a540c4d5b8bd7">Bundler</h2>

<p>一番よくわかっていないところ。Rubyで使われるGemパッケージの管理ツールらしい。ルートディレクトリにあるGemfileに書いておいたパッケージについて、依存関係をチェックして自動でインストールしてくれるものらしい。ほお。</p>

<blockquote>$ bundle install</blockquote>

<p>Railsアプリケーションを$ rails newコマンドで作成した場合、ルートディレクトリに勝手にGemfileが作られる上、$ bundle installも自動で実行されるので、あまり意識はしなくていいっぽい。Rails自体もGemで配布されているのでbundlerを使って管理させたりとかもできるみたいなんだけど、そのあたりを調べた感じ、自分には何が何を管理してるのかメタにメタ重ねる感じで徐々に訳わからん感じになってきたので考えるのを、やめた。</p>

<p>RailsアプリケーションのGemfileにはcoffescriptやSASS、SQLiteなどをインストールするように記述されている。下手にこれいじると多分死ぬと思うんだけど、SQLiteじゃなくてMySQL使いたいとか、他のGemパッケージが何か必要になったとか、そういうときは編集してあげてから$ bundle installでおｋっぽい。便利！</p>

<h2 id="git:c0e8053d95a0479a6e2a540c4d5b8bd7">Git</h2>

<p>長くなりそうなので割愛。また別の機会にまとめたい。GitHubのアカウントも持ってる（ほぼ使ってないけど。。。）し、一度RSA認証で繋げるように設定はしたことあるんだけど、完全に忘れたんでもう一度ちゃんとまとめる。今度。</p>

<p>ツールをインストールするときは依存関係の処理とかの問題があるので、後々新バージョンが出たときに惑わないよう、なるたけ自動で管理できるような入れ方をする必要がある。その視点に立って一旦まとめてはみたけど、もっと良いやり方というのも多分あるのだろう。インストールするぐらいなら猿でも出来ると思いがちだが、これがなかなか奥が深い。</p>

                </section>
            </article>
            <footer id="post-meta" class="clearfix">
                
                        <img class="avatar" src="https://chroju.github.io/images/avatar.png">
                        <div>
                            <span class="dark">the world as code</span>
                            <span></span>
                        </div>
                    
                <section id="sharing">
                    <a class="twitter" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fchroju.github.io%2fblog%2f2013%2f09%2f16%2f2013-09-16-post%2f - %e3%83%90%e3%83%bc%e3%82%b8%e3%83%a7%e3%83%b3%e7%ae%a1%e7%90%86%e3%81%ab%e6%b3%a8%e6%84%8f%e3%81%97%e3%81%aa%e3%81%8c%e3%82%89%e3%80%81Ruby%20on%20Rails%e3%81%ae%e5%8b%95%e4%bd%9c%e7%92%b0%e5%a2%83%e3%82%92%e6%a7%8b%e7%af%89%e3%81%99%e3%82%8b "><span class="icon-twitter"> Tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>

                </section>
            </footer>

            

            <ul id="post-list" class="archive readmore">
    <h3>Read more</h3>
    
    
        
        <li>
            <a href="https://chroju.github.io/blog/2016/10/25/what_is_ops/">多義化するOpsのミッションについて<aside class="dates">Oct 25</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2016/10/03/serverless-conf-tokyo/">ServerlessConfとエンジニアの職掌に関して<aside class="dates">Oct 3</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2016/08/01/soft_skills_and_our_productivity/">『SOFT SKILLS』と「やっていく気持ち」<aside class="dates">Aug 1</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2016/07/02/yapc8oji_2016/">YAPC経験ないけどパチモンの方に行った<aside class="dates">Jul 2</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2016/06/05/aws_summit_ansible_meetup_2016/">Serverlessの時代とas code<aside class="dates">Jun 5</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2016/05/14/pbtech_infra_engineers/">インフラエンジニアなので第5回ペパボテックカンファレンス行ってきた<aside class="dates">May 14</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2016/04/24/qpstudy_alert_call/">#qpstudy 響け！アラートコール！行ってきた<aside class="dates">Apr 24</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2016/03/28/entry-python/">Pythonに入門している<aside class="dates">Mar 28</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://chroju.github.io/blog/2016/03/17/personal-knowledge-base-2/">Personal Knowledge Base 2<aside class="dates">Mar 17</aside></a>
        </li>
        
   
    
        
   
</ul>
            <footer id="footer">
    
        
<div id="social">
    
    <a class="symbol" href="https://github.com/chroju">
        circlegithubalt
    </a>
    
    <a class="symbol" href="https://twitter.com/chroju">
        circletwitterbird
    </a>
    
</div>

    
    <p class="small">
    
        written by chroju
    
    </p>
</footer>

        </section>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://chroju.github.io/js/main.js"></script>
<script src="https://chroju.github.io/js/highlight.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


    </body>
</html>
