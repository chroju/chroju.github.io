<!DOCTYPE html>
<html lang="ja">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="author" content="the world as code">
<meta name="description" content="監視という、この業界に携わっていれば誰でも関係したことがあるだろう分野について、まとまった本がこれまでなかったというのは感じていて、一度「監">

<meta property="og:title" content="『入門 監視』を『ウェブオペレーション』『SRE』と一緒に読もう" />
<meta property="og:description" content="監視という、この業界に携わっていれば誰でも関係したことがあるだろう分野について、まとまった本がこれまでなかったというのは感じていて、一度「監" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chroju.github.io/blog/2019/01/31/practical_monitoring/" />
<meta property="article:published_time" content="2019-01-31T22:31:19+09:00" />
<meta property="article:modified_time" content="2019-01-31T22:31:19+09:00" />


<title>


     『入門 監視』を『ウェブオペレーション』『SRE』と一緒に読もう &middot; the world as code 

</title>
<link rel="canonical" href="https://chroju.github.io/blog/2019/01/31/practical_monitoring/">










<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500">



    
    <link rel="stylesheet" href="https://chroju.github.io/css/reset.css?t=2019-12-18%2017%3a18%3a22.970524597%20%2b0900%20JST%20m%3d%2b0.179970067">
    <link rel="stylesheet" href="https://chroju.github.io/css/pygments.css?t=2019-12-18%2017%3a18%3a22.970524597%20%2b0900%20JST%20m%3d%2b0.179970067">
    <link rel="stylesheet" href="https://chroju.github.io/css/main.css?t=2019-12-18%2017%3a18%3a22.970524597%20%2b0900%20JST%20m%3d%2b0.179970067">
    
        <link rel="stylesheet" href="https://chroju.github.io/css/override.css?t=2019-12-18%2017%3a18%3a22.970524597%20%2b0900%20JST%20m%3d%2b0.179970067">
    




<link rel="shortcut icon"

    href="https://chroju.github.io/img/favicon.ico"

>








</head>


<body lang="ja">

<section class="header">
    <div class="container">
        <div class="content">
            
                
                
                
                
                
                    
                
                    
                
                
                <a href="https://chroju.github.io/"><img class="avatar" src="https://chroju.github.io/img/avatar.png" srcset="https://chroju.github.io/img/avatar.png 1x"></a>
            
            <a href="https://chroju.github.io/"><div class="name">the world as code</div></a>
            
            <nav>
                <ul>
                    
                        <li class="nav-blog"><a href="https://chroju.github.io/blog/"><span>Archive</span></a></li>
                    
                        <li class="nav-about"><a href="https://chroju.github.io/about/"><span>About</span></a></li>
                    
                </ul>
            </nav>
        </div>
    </div>
</section>

<section class="icons">
    <div class="container">
        <div class="content">
        
            <a href="//github.com/chroju" target="_blank" rel="noopener"><img class="icon" src="https://chroju.github.io/img/github.svg" alt="github" /></a>
        

        

        
            <a href="//twitter.com/chroju" target="_blank" rel="noopener"><img class="icon" src="https://chroju.github.io/img/twitter.svg" alt="twitter" /></a>
        

	

        

        

        

        

        

        

        

        

        
            <a href="mailto:chor.chroju@gmail.com"><img class="icon" src="https://chroju.github.io/img/email.svg" alt="email" /></a>
        

        

        
        </div>
    </div>
</section>


<section class="main post non-narrow zero-top-spacing">
    <div class="container">
        <div class="content">
            <div class="front-matter">
                <div class="title-container">
                    <div class="page-heading">

    『入門 監視』を『ウェブオペレーション』『SRE』と一緒に読もう

</div>

                    <div class="initials"><a href="https://chroju.github.io"></a></div>
                </div>
                <div class="meta">
                    
                    <div class="date" title='Thu Jan 31 2019 22:31:19 JST'>Jan 31, 2019</div>
                    
                    
		    <div class="reading-time"><div class="middot"></div>5 minutes read</div>
                    
                </div>
            </div>
            <div class="markdown">
                <!-- raw HTML omitted -->
<p>監視という、この業界に携わっていれば誰でも関係したことがあるだろう分野について、まとまった本がこれまでなかったというのは感じていて、一度「監視概論」みたいなエントリーをまとめてみたいと考えていたこともあったのですが、オライリーに先を越されました（何様）。タイトルのインパクトがすごいです。</p>
<p>ただ、「監視オンリー」でまとまった本は確かに思い浮かばないものの、この分野に言及した本が一切なかったというわけではなくて、これまでですと自分は『ウェブオペレーション』と『SRE サイトリライアビリティエンジニアリング』を監視設計の上では参考にしていました。改めて本書と並行して今回この2冊もさらってみたのですが、合わせ技のように使うととてもいいのではないかなぁと思っています。</p>
<h2 id="-">入門 監視</h2>
<p>文字通り「監視」という行為自体にフォーカスしきった本という印象を受けました。1章でまずアンチパターンを挙げて、それを踏まえて2章でデザインパターンを解説する。3章では監視した結果をどう扱うのかに関わる、アラート、オンコール、インシデント管理のプロセスに触れて、4章は付随する分野である「統計」の話、5章以降が実際の監視対象別のプラクティスをまとめた各論、という感じです。まずは3章までが大前提なのでとても重要で、5章以降は実際に自分が監視するシステムの構成などに併せて参照すればいい気がしました。ネットワーク機器を監視する上での SNMP への恨みつらみが書かれた9章など、自分としてはめちゃくちゃ頷きながら読みましたが、クラウドファーストな昨今、ネットワーク機器とは無縁な人も多いでしょう。4章の「統計」もとても重要ですが、少し付随的な内容かな、という印象です。</p>
<p>とても名言が多い本で、世の中でなんとなく採用されてきたセオリーっぽいプラクティスを、きちんと理由を裏付けた上でバッサリ切ったりしてくれます。Linux 動かしてるとなんとなく CPU とメモリの使用率と各種 IO で閾値を設けがちですが、必ずしも必要ではないと言ってくれています。これすごいわかる。</p>
<blockquote>
<p>動かすサービスによっては、元々リソースをたくさん使うものもありますが、それで問題ないのです。 MySQL が継続的に CPU 全部を使っていたとしても、レスポンスタイムが許容範囲に収まっていれば何も問題はありません。これこそが、CPUやメモリ使用率のような低レベルなメトリクスではなく、「動いているか」を基準にアラートを送ることが有益である理由です。</p>
</blockquote>
<p>低レベルの監視が情報をもたらしてくれることももちろんありますが、無計画に閾値を仕掛けると、往々にして狼少年にしかならないです。この本では一貫してユーザーに近い側、ビジネス的に必要なサービスレベルを維持できているかという視点で監視をするべきだと訴えています。</p>
<p>他にも監視の設定は100％自動化するべきだとか、Ops以外も含めてチーム全員監視を扱えるスキルを持つべきだとか、昨今有効とされている話を明確に書いてくれています。それだけに我が身を振り返って胸が痛くなる部分も多いです。小説を読んでいて「心がつらい」ことを理由に一度本を閉じる、ということが稀によくあるのですが、技術書でそうなったのは初めてでした。</p>
<h2 id="sre">ウェブオペレーションとSRE</h2>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>一方の『ウェブオペレーション』ですが、『入門 監視』より7年前の本であるものの、重なる記載も少なくありません。例えば「自動的に新しいノードやメトリクスを発見する」べきであるとされていたり。</p>
<p>こちらは表題通り「オペレーション」の本なので、あくまでシステム運用をする中で必要となる一要素としての監視、として書かれている面が強いです。『入門 監視』の3章をもっと精緻にしたイメージでしょうか。例えば各コンポーネントの監視を検討する前に、技術的コンポーネントの依存関係を把握する必要があると言及されていたりします。一例としてDNSサーバーが落ちたら、いくらシステム自体は正常でもユーザーはアクセスできないよね、とか。また『入門 監視』と同様、ビジネス的なインパクトの面、つまりサービスが実際使えているかどうかという観点で監視をするべきだとしていますが、その観点についてはより詳細に分類して示しています。</p>
<blockquote>
<p>確認には5つのレベルがある。可用性（存在しているか）・機能性（動いているか）・品質（うまく動いているか）・状況（あらゆる要件を満たしているか）・信頼性（信頼できるか）だ。</p>
</blockquote>
<p>SRE本にも似たことが言えて、こちらは監視自体の言及は第10章ぐらいしかないものの、オンコール対応、SLA、ポストモーテムという、監視を取り巻くプロセスの扱い方については非常に手厚いです。SLAをきちんと設定して、その前提から考えよう、というのは、先の2冊と共通する「ユーザー視点での監視」に繋がる話で、やっぱりどれも同様の思想で書かれている本だな、と感じます。</p>
<p>ウェブオペレーションを生業としている身からすると、システム監視はやはり、あくまでシステム運用の一要素です。ですので監視だけを独立して考えることはあまりなく、全体的な運用プロセスの中に如何にして位置づけるかということをよく考えます。如何に小さなコストで間違いなく的確な監視を行うか、という。そういう観点ではやはり、SRE本や『ウェブオペレーション』に掲載されているようなマクロな観点が不可欠で、一方で『入門 監視』は、実際何をどのように監視すればいいのかという、ミクロな観点で指針を示してくれるように感じました。</p>

                <br>
                
                <p class="back-to-posts"><a href="https://chroju.github.io/blog">Back to posts</a></p>
            </div>
            <br>
            <div class="disqus">
                
            </div>
            
        </div>
    </div>
</section>









</body>
</html>

